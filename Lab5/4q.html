<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Product Inventory System</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background: #f0f2f5; padding: 20px; }
        .container { max-width: 1000px; margin: auto; background: white; padding: 25px; border-radius: 12px; box-shadow: 0 4px 20px rgba(0,0,0,0.08); }
        .stats-bar { display: flex; justify-content: space-between; margin-bottom: 20px; background: #34495e; color: white; padding: 15px; border-radius: 8px; }
        .form-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-bottom: 20px; }
        input, select { padding: 10px; border: 1px solid #ccc; border-radius: 5px; }
        button { padding: 10px; cursor: pointer; border: none; border-radius: 5px; font-weight: bold; transition: 0.3s; }
        .btn-add { background: #27ae60; color: white; grid-column: span 3; }
        .btn-update { background: #f39c12; color: white; display: none; grid-column: span 3; }
        .search-box { width: 100%; padding: 10px; margin-bottom: 20px; border: 2px solid #3498db; }
        table { width: 100%; border-collapse: collapse; }
        th, td { padding: 12px; border-bottom: 1px solid #eee; text-align: left; }
        th { background: #ecf0f1; }
        .low-stock { background-color: #fff5f5; color: #e74c3c; font-weight: bold; }
        .badge { padding: 4px 8px; border-radius: 4px; font-size: 11px; text-transform: uppercase; }
        .badge-warning { background: #ffeaa7; color: #d35400; }
        .actions button { font-size: 12px; margin-right: 5px; color: white; }
        .edit-btn { background: #3498db; }
        .del-btn { background: #e74c3c; }
    </style>
</head>
<body>
<div class="container">
    <h2>Inventory Dashboard</h2>
    <div class="stats-bar">
        <span>Total Items: <span id="totalItems">0</span></span>
        <span>Total Inventory Value: $<span id="totalValue">0.00</span></span>
    </div>
    <div class="form-grid">
        <input type="text" id="pId" placeholder="Product ID">
        <input type="text" id="pName" placeholder="Product Name">
        <select id="pCat">
            <option value="">Select Category</option>
            <option value="Electronics">Electronics</option>
            <option value="Furniture">Furniture</option>
            <option value="Stationery">Stationery</option>
        </select>
        <input type="number" id="pPrice" placeholder="Price">
        <input type="number" id="pStock" placeholder="Stock Qty">
        <button class="btn-add" onclick="addProduct()">Add Product</button>
        <button class="btn-update" id="updateBtn" onclick="saveEdit()">Update Product</button>
    </div>
    <input type="text" id="searchCat" class="search-box" placeholder="Filter by category (e.g. Electronics)..." oninput="filterByCategory()">
    <table>
        <thead>
            <tr>
                <th>ID</th>
                <th>Name</th>
                <th>Category</th>
                <th>Price</th>
                <th>Stock</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody id="inventoryBody"></tbody>
    </table>
</div>
<script>
    let inventory = [];
    let editIdx = null;
    async function loadData() {
        try {
            const res = await fetch('inventory.json');
            if (!res.ok) throw new Error("File not found");
            inventory = await res.json();
            renderUI(inventory);
        } catch (err) {
            alert("Error: " + err.message);
        }
    }
    function renderUI(data) {
        const body = document.getElementById('inventoryBody');
        body.innerHTML = '';
        let totalVal = 0;
        data.forEach((item, index) => {
            const isLow = item.stock < 5;
            totalVal += (item.price * item.stock);
            const row = `
                <tr class="${isLow ? 'low-stock' : ''}">
                    <td>${item.id}</td>
                    <td>${item.name}</td>
                    <td>${item.category}</td>
                    <td>$${item.price.toFixed(2)}</td>
                    <td>
                        ${item.stock} 
                        ${isLow ? '<span class="badge badge-warning">Low Stock</span>' : ''}
                    </td>
                    <td class="actions">
                        <button class="edit-btn" onclick="prepEdit(${index})">Edit</button>
                        <button class="del-btn" onclick="deleteItem(${index})">Delete</button>
                    </td>
                </tr>`;
            body.innerHTML += row;
        });
        document.getElementById('totalItems').textContent = inventory.length;
        document.getElementById('totalValue').textContent = totalVal.toLocaleString();
    }
    function addProduct() {
        const id = document.getElementById('pId').value.trim();
        const name = document.getElementById('pName').value.trim();
        const cat = document.getElementById('pCat').value;
        const price = parseFloat(document.getElementById('pPrice').value);
        const stock = parseInt(document.getElementById('pStock').value);
        if (!id || !name || isNaN(price) || isNaN(stock)) {
            alert("Please fill all fields correctly.");
            return;
        }
        inventory.push({ id, name, category: cat, price, stock });
        renderUI(inventory);
        clearForm();
    }
    function filterByCategory() {
        const query = document.getElementById('searchCat').value.toLowerCase();
        const filtered = inventory.filter(item => item.category.toLowerCase().includes(query));
        renderUI(filtered);
    }
    function deleteItem(index) {
        if (confirm("Delete product?")) {
            inventory.splice(index, 1);
            renderUI(inventory);
        }
    }
    function prepEdit(index) {
        editIdx = index;
        const p = inventory[index];
        document.getElementById('pId').value = p.id;
        document.getElementById('pId').disabled = true;
        document.getElementById('pName').value = p.name;
        document.getElementById('pCat').value = p.category;
        document.getElementById('pPrice').value = p.price;
        document.getElementById('pStock').value = p.stock;
        document.querySelector('.btn-add').style.display = 'none';
        document.getElementById('updateBtn').style.display = 'block';
    }
    function saveEdit() {
        inventory[editIdx].price = parseFloat(document.getElementById('pPrice').value);
        inventory[editIdx].stock = parseInt(document.getElementById('pStock').value);
        inventory[editIdx].category = document.getElementById('pCat').value;
        inventory[editIdx].name = document.getElementById('pName').value;
        renderUI(inventory);
        clearForm();
        document.querySelector('.btn-add').style.display = 'block';
        document.getElementById('updateBtn').style.display = 'none';
        document.getElementById('pId').disabled = false;
    }
    function clearForm() {
        document.querySelectorAll('input').forEach(i => i.value = '');
        document.getElementById('pCat').value = '';
        editIdx = null;
    }
    window.onload = loadData;
</script>
</body>
</html>